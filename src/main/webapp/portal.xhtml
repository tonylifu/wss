<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

<f:view contentType="text/html" contracts="common,device-desktop,theme-#{theme.name}">
    <ui:composition template="/templates/page-template.xhtml">
        <ui:param name="pageTitle" value="Create Student"/>
        <!--        <ui:define name="panel-nav">-->
        <!--            <section>-->
        <!--                <h1>Create New Student</h1>-->
        <!--                <p>Please enter details about the student.</p>-->
        <!--            </section>-->
        <!--        </ui:define>-->
        <ui:define name="panel-main">
            <section>
                <h:messages id="validation-messages" styleClass="validation-messages"/>
                <h:body>

                    <div class="content">
                        <div class="panel-top">
                            <h2>Students Record Management</h2>
                            <p>This page shows the list of all students. You can search, filter, edit, view more
                                detailed information and delete.</p>
                        </div>

                        <div class="panel-main">
                            <h2>List of Students</h2>

                            <h:form id="studentForm">
                                <h:panelGrid columns="1" styleClass="dataTableWrapper">

                                    <!-- Page Size Selector Dropdown -->
                                    <!-- Page Size Selector and Search Input -->
                                    <h:panelGroup class="paginationControls">
                                        <h:outputLabel value="Rows per page: " class="labelControl"/>
                                        <h:selectOneMenu value="#{studentBean.pageSize}" class="pageSizeDropdown">
                                            <f:selectItem itemValue="5" itemLabel="5"/>
                                            <f:selectItem itemValue="10" itemLabel="10"/>
                                            <f:selectItem itemValue="25" itemLabel="25"/>
                                            <f:selectItem itemValue="50" itemLabel="50"/>
                                            <f:selectItem itemValue="100" itemLabel="100"/>
                                            <p:ajax listener="#{studentBean.onPageSizeChange}"
                                                    update="studentForm:studentTable"/>
                                        </h:selectOneMenu>

                                        <h:outputLabel value="Search: " for="searchInput" class="labelControl"/>
                                        <h:inputText id="searchInput" value="#{studentBean.filterValue}"
                                                     placeholder="Search by name or ID" class="searchInput"/>
                                        <h:commandButton value="Search" action="#{studentBean.search}"
                                                         update="studentForm:studentTable" class="searchButton"/>
                                    </h:panelGroup>

                                    <p:dataTable id="studentTable" value="#{studentBean.students}" var="student"
                                                 paginator="false" rows="#{studentBean.pageSize}"
                                                 paginatorPosition="bottom"
                                                 emptyMessage="No students found."
                                                 style="width:100%"
                                                 paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                 rowsPerPageTemplate="5,10,25,50,100"
                                                 lazy="false"
                                                 sortBy="#{studentBean.sortBy}"
                                                 filterBy="#{studentBean.filterValue}"
                                                 rowKey="#{student.studentId}"
                                                 widgetVar="studentTable">

                                        <!-- Columns with Sorting and Filtering -->
                                        <p:column headerText="ID" sortBy="#{student.studentId}"
                                                  filterBy="#{student.studentId}">
                                            <h:outputText value="#{student.studentId}"/>
                                        </p:column>

                                        <p:column headerText="First Name" sortBy="#{student.firstName}"
                                                  filterBy="#{student.firstName}">
                                            <h:outputText value="#{student.firstName}"/>
                                        </p:column>

                                        <p:column headerText="Last Name" sortBy="#{student.lastName}"
                                                  filterBy="#{student.lastName}">
                                            <h:outputText value="#{student.lastName}"/>
                                        </p:column>

                                        <p:column headerText="Gender" sortBy="#{student.gender}"
                                                  filterBy="#{student.gender}">
                                            <h:outputText value="#{student.gender}"/>
                                        </p:column>

                                        <p:column headerText="Current Grade" sortBy="#{student.currentGrade}"
                                                  filterBy="#{student.currentGrade}">
                                            <h:outputText value="#{student.currentGrade}"/>
                                        </p:column>

                                        <p:column headerText="Status" sortBy="#{student.studentStatus}"
                                                  filterBy="#{student.studentStatus}">
                                            <h:outputText value="#{student.studentStatus}"/>
                                        </p:column>

                                        <p:column headerText="Actions">
                                            <p:commandButton value="Edit" action="#{studentBean.edit(student)}"
                                                             update="@form"/>
                                            <p:commandButton value="View" action="#{studentBean.view(student)}"
                                                             update="@form"
                                                             oncomplete="PF('studentDialog').show()"/>
                                        </p:column>

                                    </p:dataTable>

                                    <!-- Display current page number -->
                                    <h:outputText value="Current Page: #{studentBean.pageNumber + 1}"/>

                                    <!--                    <h:panelGroup styleClass="paginationButtons">-->
                                    <!--                        <p:commandButton value="Previous" action="#{studentBean.previousPage}"-->
                                    <!--                                         update="studentForm:studentTable"-->
                                    <!--                                         disabled="#{studentBean.pageNumber == 0}" enabled="#{studentBean.pageNumber > 0}" />-->
                                    <!--                        <p:commandButton value="Next" action="#{studentBean.nextPage}"-->
                                    <!--                                         update="studentForm:studentTable"-->
                                    <!--                                         disabled="#{studentBean.pageNumber >= studentBean.totalPages}"/>-->
                                    <!--                    </h:panelGroup>-->

                                    <h:panelGroup styleClass="paginationButtons">
                                        <h:commandButton value="Previous" action="#{studentBean.previousPage}"
                                                         disabled="#{studentBean.pageNumber == 0}"
                                                         class="navigationButton"/>
                                        <h:outputText value=" "/>
                                        <h:commandButton value="Next" action="#{studentBean.nextPage}"
                                                         disabled="#{studentBean.pageNumber >= studentBean.totalPages}"
                                                         class="navigationButton"/>

                                    </h:panelGroup>

                                </h:panelGrid>
                            </h:form>

                        </div>
                    </div>

                </h:body>
            </section>
        </ui:define>
    </ui:composition>
</f:view>
</html>
